---
title: TypeScript çŸ¥è¯†ç‚¹æ€»ç»“
date: 2021-04-08
tags: [TypeScript]
excerpt: TSä»‹ç»ï¼Œç¼–è¯‘å™¨ï¼ŒåŸºæœ¬æ•°æ®ç±»å‹ï¼Œæ¥å£ï¼Œæ³›å‹ï¼Œé«˜çº§ç”¨æ³•...
---

```toc
# This code block gets replaced with the TOC
```

<Info title="å‰è¨€">

## å‰è¨€

### TypeScript ä¸‰å¤§ç–‘é—®

**1. æ˜¯ä»€ä¹ˆï¼Ÿ**

TypeScriptï¼ˆç®€ç§° TSï¼‰æ˜¯ä¸€é—¨è®² JavaScript è¿›è¡Œå°è£…ï¼Œå¯¹ç±»å‹è¿›è¡Œé™æ€æ£€æŸ¥çš„å·¥å…· - `tools`ï¼ˆ[å®˜æ–¹](https://www.typescriptlang.org/)æ˜¯è¿™ä¹ˆè¯´çš„ï¼‰ï¼Œç®€å•æ¥è¯´ï¼Œå¯ä»¥å°† TS ç†è§£ä¸º JS çš„è¶…é›†ï¼Œå¦‚æœä½ ç†Ÿæ‚‰ ES5/6ï¼Œé‚£ä¹ˆ TS å’Œä»–ä»¬çš„å…³ç³»å¯ä»¥å½¢è±¡çš„æç»˜æˆä¸‹å›¾

![](https://thumbsnap.com/i/u81p6GFb.png?0409)

TS æä¾›äº†é™æ€ç±»å‹å®šä¹‰çš„åŠŸèƒ½ï¼Œçµæ´»çš„æ¥å£åŠå¤æ‚å¯¹è±¡çš„å®šä¹‰ï¼Œä½¿å¾— TS æˆä¸ºååˆ†å¼ºå¤§çš„å·¥å…·ï¼Œåœ¨ç¤¾åŒºä¿æŒç€éå¸¸é«˜çš„æ´»è·ƒåº¦ï¼Œä¸æ­¤åŒæ—¶ï¼ŒTS ä¹Ÿæ˜¯å¾®è½¯çš„å¼€æºé¡¹ç›®ï¼Œä½ ç”šè‡³å¯ä»¥åˆ° github æŸ¥çœ‹ TS çš„æºç ï¼Œæ issue å’Œ PR ã€‚

**2. ä¸ºä»€ä¹ˆï¼Ÿ**

æˆ‘ä»¬å…ˆçœ‹çœ‹åœ¨ JavaScript é¡¹ç›®ä¸­æœ€å¸¸è§çš„åå¤§é”™è¯¯ï¼š

![](https://thumbsnap.com/i/tQsEEBNJ.png?0409)

æˆ‘ä»¬æ˜¯ä¸æ˜¯è€³ç†Ÿèƒ½è¯¦ï¼Ÿè¿™äº›ä½çº§é”™è¯¯å ç”¨äº†å¤§é‡ debug å’Œ google çš„æ—¶é—´ï¼Œè€Œå¦‚æœä½ ç”¨ TypeScript å¯ä»¥åœ¨ç¼–å†™é˜¶æ®µå°±è§„é¿äº†ï¼Œè‡ªä»æˆ‘ä»¬ç”¨äº† TypeScript ä¹‹åï¼Œä½çº§æŠ¥é”™åŸºæœ¬å°±æ²¡çŠ¯è¿‡ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹æ˜¯æˆ‘ä»¬è‡ªèº«ç¼–å†™çš„ç¨‹åºé€»è¾‘é”™è¯¯ã€‚

å¾ˆå¤šé¡¹ç›®ï¼Œå°¤å…¶æ˜¯ä¸­å¤§å‹é¡¹ç›®ï¼Œæˆ‘ä»¬æ˜¯éœ€è¦å›¢é˜Ÿå¤šäººåä½œçš„ï¼Œé‚£ä¹ˆå¦‚ä½•ä¿è¯åä½œå‘¢ï¼Ÿè¿™ä¸ªæ—¶å€™å¯èƒ½éœ€è¦å¤§é‡çš„æ–‡æ¡£å’Œæ³¨é‡Šï¼Œæ˜¾å¼ç±»å‹å°±æ˜¯æœ€å¥½çš„æ³¨é‡Šï¼Œè€Œé€šè¿‡ TypeScript æä¾›çš„ç±»å‹æç¤ºåŠŸèƒ½æˆ‘ä»¬å¯ä»¥éå¸¸èˆ’æœåœ°è°ƒç”¨åŒä¼´çš„ä»£ç ï¼Œç”±äº TypeScript çš„å­˜åœ¨æˆ‘ä»¬å¯ä»¥èŠ‚çœå¤§é‡æ²Ÿé€šæˆæœ¬ã€ä»£ç é˜…è¯»æˆæœ¬ç­‰ç­‰ã€‚

![](https://thumbsnap.com/i/8jL1wfCb.png?0409)

å¦‚æœä¸Šè¿°ä¸¤ä¸ªä¸»è¦ä¼˜ç‚¹è¿˜ä¸èƒ½å¸å¼•ä½ çš„è¯ï¼Œé‚£ä¹ˆæˆ‘å¯ä»¥è´Ÿè´£ä»»åœ°å‘Šè¯‰ä½ ï¼Œå‡èŒåŠ è–ªéœ€è¦ TSï¼Œæ€ä¹ˆæ ·ï¼Œé¦™ä¸é¦™ XD

**3. æ€ä¹ˆåšåˆ°çš„ï¼Ÿ**

åˆ†ä¸¤ç§æ¨¡å¼ï¼š

1. å¦‚æœåœ¨ `tsc` ç­‰æŒ‡ä»¤æ‰§è¡Œä¹‹å‰ï¼ŒIDE å‘ç°äº† ts ä¸­çš„è¯­æ³•é”™è¯¯ï¼Œè¿™æ˜¯é€šè¿‡ IDE å’Œ LSP æ¥å®ç°çš„ï¼Œæ›´ä¸ºè¯¦ç»†çš„è®²è§£åœ¨[ä¸‹ä¸€èŠ‚](#â…¡. TypeScript å·¥ä½œåŸç†)
2. Typescript ç¼–è¯‘å™¨å°†å¯¹åº”çš„ ts æ–‡ä»¶ï¼Œæ ¹æ®ä½ åœ¨ tsconfig.json ä¸­æŒ‡å®šå¥½çš„æ¨¡å¼ï¼Œå°† ts æ–‡ä»¶ç¼–è¯‘æˆ js æ–‡ä»¶ï¼Œè¿™ä¸ªç¼–è¯‘å™¨å€ŸåŠ© node å¼•æ“å®ç°ï¼Œå¹¶åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­å¯¹ ts ä»£ç è¿›è¡Œæ£€æŸ¥ï¼Œå¦‚æœå‘ç°é”™è¯¯åˆ™åœæ­¢ç¼–è¯‘ï¼Œå¹¶æ‰“å°é”™è¯¯ä¿¡æ¯ã€‚å¦‚æœæœ‰ map æ–‡ä»¶ï¼Œè¿˜ä¼šæç¤ºå¯¹åº” ts æ–‡ä»¶ä¸­å‡ºé”™çš„è¡Œæ•°

**4. æƒè¡¡**

ä¸€ä¸ªæ–°çš„æŠ€æœ¯ï¼Œåœ¨ä½¿ç”¨ä¹‹å‰çš„è°ƒç ”é˜¶æ®µï¼Œé€šå¸¸éƒ½ä¼šå¯¹å…¶è¿›è¡Œæƒè¡¡ï¼Œå› ä¸ºå¤§éƒ¨åˆ†æƒ…å†µä¸‹è¿™é¡¹æŠ€æœ¯ä¸€å®šæœ‰ä¼˜ç¼ºç‚¹ï¼Œæœ‰å®ƒè‡ªèº«çš„é€‚ç”¨åœºæ™¯ï¼Œé‚£ä¹ˆå¯¹äº TS æ¥è¯´ï¼Œä¸Šé¢è¯´äº†é‚£ä¹ˆå¤šä¼˜ç‚¹ï¼Œä¸‹é¢è¯´ä¸€ä¸‹ä¸»è¦é—®é¢˜ï¼š

- é…ç½®ä»¥åŠç”¨å¥½ TS éœ€è¦ä¸€å®šçš„å­¦ä¹ æˆæœ¬ï¼Œå¹¶ä¸”ç”±äº TS æŠ€æœ¯ä¸å¦‚ JS é‚£ä¹ˆæˆç†Ÿï¼Œç¤¾åŒºä¹Ÿä¸å¦‚ JS ä¸°å¯Œï¼Œå¯¹äºä¸€äº›é—®é¢˜è§£ç­”ä»¥åŠå·¥å…·æ•°é‡éƒ½è¿œä¸å¦‚ JS å’Œ nodeï¼Œéœ€è¦æ‰¿æ‹…ä¸€å®šçš„é£é™©
- å¦‚æœä¸æ‰“ç®—é‡å†™ JS é¡¹ç›®ï¼Œåªæ˜¯åŠ ä¸Š TS ç¼–è¯‘å™¨çš„è¯ï¼ŒåŸå…ˆçš„ç»„ä»¶æ¥å£å¹¶ä¸èƒ½äº«å— TS å¸¦æ¥çš„çº¢åˆ©â€”â€” IDE ä¸­è¾“å…¥æˆ–è€…é¼ æ ‡æ‚¬æµ®æ²¡æœ‰æ¥å£å‚æ•°æç¤ºï¼Œæ²¡æœ‰ç±»å‹æ£€æŸ¥ï¼Œè¿™æ ·å…¶å®ä½¿ç”¨ TS çš„æ„ä¹‰å°±å°äº†å¾ˆå¤šã€‚

ä½†æ˜¯ç»¼ä¸Šæ¥çœ‹ï¼Œç»å¤§éƒ¨åˆ†åœºæ™¯ä¸‹ä½¿ç”¨ TS æ˜¯åˆ©å¤§äºå¼Šçš„ï¼Œå³ä¾¿æ˜¯å¯¹äºä¸ªäººé¡¹ç›®è€Œè¨€ï¼Œå‡å°‘ä¸å¿…è¦çš„ä½çº§é”™è¯¯æ‰€çœä¸‹çš„æ—¶é—´ï¼Œé€šå¸¸æ¥è¯´éƒ½æ¯”ä½ å¤šå†™ä¸€äº› TS ç±»å‹å®šä¹‰çš„ä»£ç èŠ±è´¹æ—¶é—´è¦å¤šï¼Œåªæ˜¯éœ€è¦ä½ å­¦ä¼š TS å¹¶ç”¨å¥½ TS : )

æ€»è€Œè¨€ä¹‹ï¼Œä½ å¯ä»¥å°† TS å½“åšä¸€ç§è¯­æ³•ç³–ï¼Œä½† TS çš„æ ¸å¿ƒæ€æƒ³æ˜¯æƒ³è®² JS è½¬æ¢æˆé™æ€è¯­è¨€ï¼Œå¦‚æœå¾®è½¯çœŸçš„åœ¨ä¸‹ä¸€ç›˜å¤§æ£‹ï¼ŒTS ç§¯ç´¯äº†è¶³å¤Ÿçš„ç”¨æˆ·ç¾¤ä½“åï¼Œè„±ç¦» V8ï¼Œbabel ç­‰ç¼–è¯‘ç¯å¢ƒï¼Œæˆä¸ºçœŸæ­£çš„é™æ€è¯­è¨€çš„è¯ï¼Œé‚£å°±çœŸæ˜¯å°†å‰ç«¯å½»åº•æ´—ç‰Œäº†ï¼Œä¸å¯è°“ä¸ NB å•Šï¼å½“ç„¶ç›®å‰ä»…ä»…æ˜¯å¯¹å…¶çš„çŒœæµ‹ï¼Œå…·ä½“å¦‚ä½•ï¼Œéœ€è¦ç»§ç»­è§‚æœ›ï¼Œä½†æ˜¯æ— è®ºæ€æ ·ï¼Œä½¿ç”¨ TS ä¾ç„¶æˆä¸ºä¸€ç§æµè¡Œè¶‹åŠ¿ï¼ŒTS ç¡®å®æ˜¯ä¸€ä¸ªå¼ºå¤§è€Œé«˜æ•ˆçš„å·¥å…·ï¼Œèƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬åœ¨å¤§å‹ node é¡¹ç›®å¼€å‘è¿‡ç¨‹ä¸­é¿å…ä¸€äº›ä½çº§é”™è¯¯ä»¥åŠæ›´å¥½çš„ IDE æ¥å£æç¤ºï¼Œæé«˜å›¢é˜Ÿæ•´ä½“çš„å¼€å‘æ•ˆç‡ã€‚

TS æ˜¯ä¸æ˜¯é“¶å¼¹ï¼Œæˆ‘ä»¬ä¸å¾—è€ŒçŸ¥ï¼Œä½†æ˜¯å­¦å¥½å¹¶ç”¨å¥½ TSï¼Œä¸€å®šå¯¹ä½ çš„å‰ç«¯ç”Ÿæ¶¯æœ‰ä¸å°çš„å¸®åŠ©

### TypeScript å·¥ä½œåŸç†

è¦ç”¨å¥½ TSï¼Œä¸€ä¸ªå¥½çš„ IDE æ˜¯å¿…é¡»çš„ï¼Œé¦–æ¨ VS Codeï¼Œå› ä¸ºæ˜¯å¾®è½¯è‡ªå®¶çš„äº§å“ï¼Œè‡ªç„¶æ•´åˆçš„æœ€å¥½ã€‚

é‚£ä¹ˆä¸ºä»€ä¹ˆä¸€å®šè¦ IDE å‘¢ï¼Œè¿™ä¹Ÿå’Œ TS çš„å·¥ä½œæœºåˆ¶æœ‰å…³ï¼ŒTS çš„æºä»£ç æ˜¯ä»¥ä¸¤ç§ç‹¬ç«‹æ–¹å¼å¤„ç†çš„ï¼š

- æ£€æŸ¥æ‰“å¼€çš„ç¼–è¾‘å™¨æ˜¯å¦å­˜åœ¨é”™è¯¯ï¼šè¿™æ˜¯é€šè¿‡æ‰€è°“çš„ [_language server_](https://langserver.org/) å®Œæˆçš„ã€‚å®ƒä»¬æ˜¯ä¸ç¼–è¾‘å™¨æ— å…³çš„æ–¹æ³•ï¼Œå¯ä¸ºç¼–è¾‘å™¨æä¾›ä¸è¯­è¨€ç›¸å…³çš„æœåŠ¡ï¼ˆæ£€æµ‹é”™è¯¯ã€é‡æ„ã€è‡ªåŠ¨å®Œæˆç­‰ï¼‰ã€‚ç¼–è¾‘å™¨ï¼ˆä¾‹å¦‚ IDEï¼‰é€šè¿‡ç‰¹æ®Šåè®®ï¼ˆJSON-RPCï¼Œå³åŸºäº JSON çš„è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼‰ä¸è¯­è¨€æœåŠ¡å™¨è¿›è¡Œé€šä¿¡ã€‚è¿™æ ·ä¸€æ¥ï¼Œå‡ ä¹å¯ä»¥ç”¨ä»»ä½•ç¼–ç¨‹è¯­è¨€ç¼–å†™æ­¤ç±»æœåŠ¡å™¨ã€‚
  - è¦è®°ä½ï¼šlanguage server ä»…åˆ—å‡ºå½“å‰æ‰“å¼€çš„ç¼–è¾‘å™¨çš„é”™è¯¯ï¼Œä¸”ä¸ç¼–è¯‘ TypeScriptï¼Œè€Œæ˜¯ä»…ä»…é™æ€åˆ†æå®ƒã€‚
- _Building_ï¼ˆå°† TypeScript æ–‡ä»¶ç¼–è¯‘ä¸º JavaScript æ–‡ä»¶ï¼‰ï¼šåœ¨è¿™é‡Œï¼Œæˆ‘ä»¬æœ‰ä¸¤ä¸ªé€‰æ‹©ã€‚
  - æˆ‘ä»¬å¯ä»¥é€šè¿‡å‘½ä»¤è¡Œè¿è¡Œæ„å»ºå·¥å…·ã€‚ä¾‹å¦‚ï¼ŒTypeScript ç¼–è¯‘å™¨ `tsc` æœ‰ `--watch` æ¨¡å¼ï¼Œè¯¥æ¨¡å¼å¯ä»¥ç›‘è§†è¾“å…¥æ–‡ä»¶ï¼Œå¹¶åœ¨æ›´æ”¹æ–‡ä»¶æ—¶å°†å…¶ç¼–è¯‘ä¸ºè¾“å‡ºæ–‡ä»¶ã€‚è¿™æ ·ï¼Œæ¯å½“æˆ‘ä»¬åœ¨ IDE ä¸­ä¿å­˜ TypeScript æ–‡ä»¶æ—¶ï¼Œéƒ½ä¼šç«‹å³è·å¾—ç›¸åº”çš„è¾“å‡ºæ–‡ä»¶ã€‚
  - æˆ‘ä»¬å¯ä»¥åœ¨ Visual Studio Code ä¸­è¿è¡Œ `tsc`ã€‚ä¸ºæ­¤ï¼Œå¿…é¡»å°†å…¶å®‰è£…åœ¨æˆ‘ä»¬å½“å‰æ­£åœ¨å¼€å‘çš„é¡¹ç›®å†…éƒ¨æˆ–è¿›è¡Œå…¨å±€å®‰è£…ï¼ˆé€šè¿‡ Node.js åŒ…ç®¡ç†å™¨ npmï¼‰ã€‚

é€šè¿‡æ„å»ºï¼Œæˆ‘ä»¬å¯ä»¥è·å¾—å®Œæ•´çš„é”™è¯¯åˆ—è¡¨ã€‚æœ‰å…³åœ¨ Visual Studio Code ä¸­ç¼–è¯‘ TypeScript çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚è§[è¯¥ IDE çš„å®˜æ–¹æ–‡æ¡£](https://code.visualstudio.com/docs/typescript/typescript-compiling)ã€‚

ç»™å®š TypeScript æ–‡ä»¶ `main.ts`ï¼ŒTypeScript ç¼–è¯‘å™¨å¯ä»¥äº§ç”Ÿå‡ ç§å·¥ä»¶ã€‚æœ€å¸¸è§çš„æ˜¯ï¼š

- JavaScript æ–‡ä»¶ï¼š`main.js`
- å£°æ˜æ–‡ä»¶ï¼š`main.d.ts`ï¼ˆåŒ…å«ç±»å‹ä¿¡æ¯ï¼‰
- æºç æ˜ å°„æ–‡ä»¶ï¼š`main.js.map`

TypeScript é€šå¸¸ä¸æ˜¯é€šè¿‡ `.ts` æ–‡ä»¶æä¾›çš„ï¼Œè€Œæ˜¯é€šè¿‡ `.js` æ–‡ä»¶å’Œ `.d.ts` æ–‡ä»¶æä¾›ï¼š

- JavaScript ä»£ç åŒ…å«å®é™…çš„åŠŸèƒ½ï¼Œå¯ä»¥é€šè¿‡æ™®é€š JavaScript ä½¿ç”¨ã€‚
- å£°æ˜æ–‡ä»¶å¯å¸®åŠ©ç¼–ç¨‹ç¼–è¾‘è€…å®ç°è‡ªåŠ¨è¡¥å…¨å’Œç±»ä¼¼çš„æœåŠ¡ã€‚æ­¤ä¿¡æ¯ä½¿æ™®é€š JavaScript å¯ä»¥é€šè¿‡ TypeScript ä½¿ç”¨ã€‚ä½†æ˜¯å¦‚æœä½¿ç”¨çº¯ JavaScriptï¼Œæˆ‘ä»¬ç”šè‡³ä¼šä»ä¸­å—ç›Šï¼Œå› ä¸ºå®ƒå¯ä»¥æä¾›æ›´å¥½çš„è‡ªåŠ¨å®Œæˆä»¥åŠæ›´å¤šåŠŸèƒ½ã€‚

æºç æ˜ å°„ä¸º `main.js` ä¸­è¾“å‡ºä»£ç çš„æ¯ä¸€éƒ¨åˆ†æŒ‡å®šåœ¨ `main.ts` ä¸­çš„è¾“å…¥ä»£ç çš„å“ªä¸€éƒ¨åˆ†ç”Ÿæˆäº†å®ƒã€‚é™¤å…¶ä»–å¤–ï¼Œæ­¤ä¿¡æ¯ä½¿è¿è¡Œæ—¶ç¯å¢ƒèƒ½å¤Ÿæ‰§è¡Œ JavaScript ä»£ç ï¼ŒåŒæ—¶åœ¨é”™è¯¯ä¿¡æ¯ä¸­æ˜¾ç¤º TypeScript ä»£ç çš„è¡Œå·ã€‚

### TypeScript for Tooling

TypeScript é™¤äº†èƒ½å¤Ÿå‘ç°æˆ‘ä»¬ ts code ä¸­çš„ bugï¼Œè¿˜å¯ä»¥åœ¨ä½ ç¼–è¾‘çš„æ—¶å€™å°±å¸®åŠ©ä½ æ›´å¥½åœ°é¿å…äº§ç”Ÿè¿™äº› bugï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨ IDE ä¸­èƒ½å¸®åŠ©æˆ‘ä»¬ codingï¼ŒåŒ…æ‹¬å‡½æ•°è°ƒç”¨æç¤ºé¢æ¿ï¼Œè‡ªåŠ¨ä¿®å¤æç¤ºï¼ˆquick fixesï¼‰ï¼Œç›´æ¥è·³è½¬åˆ°æ¥å£å®šä¹‰ç­‰ç­‰ã€‚è¿™äº›åŠŸèƒ½éƒ½æ˜¯é€šè¿‡ type-check å®ç°çš„ï¼Œè€Œä»¥ä¸‹è¿™äº›ä¸»æµ IDE éƒ½å¯¹ TS æœ‰è‰¯å¥½çš„æ”¯æŒï¼Œå¹¶ä¸”æ˜¯è·¨å¹³å°çš„ï¼š

- [alm.tools](https://github.com/Microsoft/TypeScript/wiki/TypeScript-Editor-Support#alm)
- [Atom](https://github.com/Microsoft/TypeScript/wiki/TypeScript-Editor-Support#atom)
- [CATS](https://github.com/Microsoft/TypeScript/wiki/TypeScript-Editor-Support#cats)
- [Eclipse](https://github.com/Microsoft/TypeScript/wiki/TypeScript-Editor-Support#eclipse)
- [Emacs](https://github.com/Microsoft/TypeScript/wiki/TypeScript-Editor-Support#emacs)
- [NeoVim](https://github.com/Microsoft/TypeScript/wiki/TypeScript-Editor-Support#neovim)
- [NetBeans](https://github.com/Microsoft/TypeScript/wiki/TypeScript-Editor-Support#netbeans)
- [Notepad++](https://github.com/Microsoft/TypeScript/wiki/TypeScript-Editor-Support#notepad)
- [Sublime Text](https://github.com/Microsoft/TypeScript/wiki/TypeScript-Editor-Support#sublime-text)
- [Vim](https://github.com/Microsoft/TypeScript/wiki/TypeScript-Editor-Support#vim)
- [Visual Studio](https://github.com/Microsoft/TypeScript/wiki/TypeScript-Editor-Support#visual-studio-20132015)
- [Visual Studio Code](https://github.com/Microsoft/TypeScript/wiki/TypeScript-Editor-Support#visual-studio-code)
- [WebStorm](https://github.com/Microsoft/TypeScript/wiki/TypeScript-Editor-Support#webstorm)

è¯¦ç»†å¯ä»¥æŸ¥çœ‹[å®˜æ–¹æ–‡æ¡£](https://github.com/Microsoft/TypeScript/wiki/TypeScript-Editor-Support)

### the TypeScript compiler

ä¸»æµçš„ TS ç¼–è¯‘å™¨å·¥å…·æœ‰ 3 ä¸ªï¼š

- tscï¼šTS å®˜æ–¹çš„ç¼–è¯‘å™¨ï¼Œä½œä¸º type-checkerï¼Œåªæœ‰ tsc å¯ä»¥åš type-checkingï¼Œä»£ä»·å°±æ˜¯è€—æ—¶ï¼ŒåŒæ—¶å…¶ç¼–è¯‘å‚æ•°ä¹Ÿæ˜¯æœ€ä¸°å¯Œçš„ã€‚
- ts-nodeï¼šç›¸å½“äºæ˜¯ä¸€ä¸ª node çš„å¯æ‰§è¡Œç¯å¢ƒï¼Œå¹¶ä¸”åŒ…å« TS æ”¯æŒçš„æ¨¡å—å¯ä»¥è¿è¡Œè¿‡ç¨‹ä¸­ç¼–è¯‘ TSï¼Œå®é™…ä½¿ç”¨ä¸­å°±ç›¸å½“äºå¯ä»¥ç›´æ¥æ‰§è¡Œ ts æ–‡ä»¶è€Œä¸ç”¨è¾“å‡º jsï¼Œå¦å¤–ï¼Œts-node å¯ä»¥æŒ‡å®š TS ç¼–è¯‘å™¨ï¼Œé»˜è®¤æ˜¯ç”¨ tsc
- babel + ts-pluginï¼šbabel æœ‰è‡ªå·±çš„ TS è½¬æ¢æ’ä»¶ `@babel/plugin-transform-typescript`ï¼Œä½†æ˜¯è¿™ä¸ªæ’ä»¶ç›¸æ¯” tsc å°‘äº†ä¸€äº›åŠŸèƒ½ï¼šå®ƒæ²¡æœ‰ type-checkingï¼Œå¹¶ä¸”åªä¼šè½¬æ¢å•ä¸ªæ–‡ä»¶ï¼Œå¯¼è‡´å…¶æ— æ³•ç†è§£æ•´ä¸ªé¡¹ç›®çš„ç±»å‹ç³»ç»Ÿï¼Œå¦‚æœæŒ‡å®š ts-config çš„ `isolatedModules `å¯ä»¥å‘Šè¯‰ TS å¦‚æœæœ‰ä¸€äº›æ–‡ä»¶æ— æ³•ç”¨ babel è¿™æ ·çš„å•æ–‡ä»¶è½¬æ¢å·¥å…·è¿›è¡Œæ­£ç¡®åœ°è§£é‡Šï¼Œå°±è¿›è¡Œ warn æç¤º

é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰ `swc` ä»¥åŠ `Sucrase` ç­‰æ˜¯å¯å…¼å®¹ TS çš„è½¬æ¢å™¨ï¼ˆæ³¨æ„ï¼Œæ˜¯ transpilerï¼Œè€Œä¸æ˜¯ compilerï¼Œåªæœ‰ tsc æ˜¯ compilerï¼‰

#### å…³äº TS ä¸­çš„ Errors

å¦‚æœåœ¨ ts æ–‡ä»¶ä¸­æœ‰é”™è¯¯ï¼Œç”¨ `tsc` ç¼–è¯‘æ—¶é»˜è®¤ä¾ç„¶ä¼šè¾“å‡º js æ–‡ä»¶ï¼Œç”šè‡³æœ‰å¯èƒ½ä½ èƒ½æˆåŠŸè¿è¡Œè¯¥ js æ–‡ä»¶ï¼Œä½†æ˜¯è¡Œä¸ºä¸ç¬¦åˆé¢„æœŸï¼Œä¾‹å¦‚ï¼š

```typescript
// This is an industrial-grade general-purpose greeter function:
function greet(person, date) {
  console.log(`Hello ${person}, today is ${date}!`)
}

greet("Brendan")
```

`tsc` ä¹‹åä½ å¯ä»¥å¾—åˆ°ï¼š

```javascript
// This is an industrial-grade general-purpose greeter function:
function greet(person, date) {
  console.log("Hello " + person + ", today is " + date + "!")
}
greet("Brendan")
```

ç”šè‡³ä½ è¿è¡Œå¯ä»¥çœ‹åˆ°ç»“æœ

```
Hello Brendan, today is undefined!
```

ä½†æ˜¯ undefined å¤šåŠä¸æ˜¯æˆ‘ä»¬çš„é¢„æœŸç»“æœ

å¦‚æœæƒ³è¦è®© `tsc` åœ¨ç¼–è¯‘æ—¶ä¸ skip errorï¼Œä¸€æ—¦æœ‰é”™å°±ä¸ç”Ÿæˆ js æ–‡ä»¶çš„è¯ï¼Œå¯ä»¥æ·»åŠ  `--noEmitOnError`å‚æ•°ï¼Œä¾‹å¦‚ä¸Šè¿°æ–‡ä»¶ï¼ˆå‡è®¾ä¸º `ts_study.ts`ï¼‰ï¼Œè¿è¡Œ

```shell
â¯ tsc --noEmitOnError ts_study.ts
ts_study.ts:17:1 - error TS2554: Expected 2 arguments, but got 1.

17 greet("Brendan");
   ~~~~~~~~~~~~~~~~

  ts_study.ts:13:24
    13 function greet(person, date) {
                              ~~~~
    An argument for 'date' was not provided.


Found 1 error.
```

å°±ä¼šæç¤ºæŠ¥é”™ï¼Œå¹¶ä¸”ä¸ç”Ÿæˆå¯¹åº”çš„ js æ–‡ä»¶

### TypeScript ç¼–è¯‘ JavaScript

TypeScript ç¼–è¯‘å™¨è¿˜å¯ä»¥å¤„ç†æ™®é€šçš„ JavaScript æ–‡ä»¶ï¼š

- ä½¿ç”¨é€‰é¡¹ `--allowJs`ï¼ŒTypeScript ç¼–è¯‘å™¨å°†è¾“å…¥ç›®å½•ä¸­çš„ JavaScript æ–‡ä»¶å¤åˆ¶åˆ°è¾“å‡ºç›®å½•ä¸­ã€‚å¥½å¤„ï¼šå½“[ä» JavaScript è¿ç§»åˆ° TypeScript](https://mp.weixin.qq.com/s/-NEcWkXssKGQh2HDVtBLhA) æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆä½¿ JavaScript å’Œ TypeScript æ–‡ä»¶æ··åˆå­˜åœ¨ï¼Œç„¶åå†æ…¢æ…¢æŠŠæ›´å¤š JavaScript æ–‡ä»¶è½¬æ¢ä¸º TypeScript ã€‚
- ä½¿ç”¨é€‰é¡¹ `--checkJs`ï¼Œç¼–è¯‘å™¨è¿˜ä¼šå¯¹ JavaScript æ–‡ä»¶è¿›è¡Œç±»å‹æ£€æŸ¥ï¼ˆå¿…é¡»å¯ç”¨ `--allowJs` æ‰èƒ½ä½¿è¯¥é€‰é¡¹èµ·ä½œç”¨ï¼‰ã€‚é‰´äºå¯ç”¨ä¿¡æ¯æœ‰é™ï¼Œå®ƒä¼šå°½å…¶æ‰€èƒ½ã€‚
- å¦‚æœ JavaScript æ–‡ä»¶åŒ…å«æ³¨é‡Š `//@ts-nocheck`ï¼Œåˆ™ä¸ä¼šå¯¹å…¶è¿›è¡Œç±»å‹æ£€æŸ¥ã€‚
  - å¦‚æœæ²¡æœ‰ `--checkJs`ï¼Œæ³¨é‡Š `//@ts-check` å¯ç”¨äºå¯¹å•ä¸ª JavaScript æ–‡ä»¶è¿›è¡Œç±»å‹æ£€æŸ¥ã€‚
- TypeScript ç¼–è¯‘å™¨ä½¿ç”¨é€šè¿‡ JSDoc æ³¨é‡ŠæŒ‡å®šçš„é™æ€ç±»å‹ä¿¡æ¯ï¼ˆè¯·å‚è§ä¸‹é¢çš„ä¾‹å­ï¼‰ã€‚å¦‚æœå¯ä»¥çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥å®Œå…¨é™æ€ç±»å‹åŒ–çº¯ JavaScript æ–‡ä»¶ï¼Œç”šè‡³å¯ä»¥æ´¾ç”Ÿå®ƒä»¬çš„å£°æ˜æ–‡ä»¶ã€‚
- ä½¿ç”¨é€‰é¡¹ `--noEmit`ï¼Œç¼–è¯‘å™¨ä¸ä¼šäº§ç”Ÿä»»ä½•è¾“å‡ºï¼Œå®ƒåªä¼šå¯¹æ–‡ä»¶è¿›è¡Œç±»å‹æ£€æŸ¥ã€‚

This is an example of a JSDoc comment that provides static type information for a function `add()`:
è¿™æ˜¯ä¸€ä¸ª JSDoc æ³¨é‡Šçš„ä¾‹å­ï¼Œå®ƒä¸ºå‡½æ•° `add()` æä¾›é™æ€ç±»å‹ä¿¡æ¯ï¼š

```
/**
 * @param {number} x - A number param.
 * @param {number} y - A number param.
 * @returns {number} This is the result
 */
function add(x, y) {
  return x + y;
}
```

è¯¦ç»†ä¿¡æ¯ï¼šã€Š TypeScript æ‰‹å†Œã€‹ä¸­çš„ [Type-Checking JavaScript Files](https://www.typescriptlang.org/docs/handbook/type-checking-javascript-files.html)ã€‚

### å…³äºæ‰“åŒ…

npm æ³¨å†Œè¡¨æ˜¯ä¸€ä¸ªå·¨å¤§çš„ JavaScript ä»£ç åº“ã€‚å¦‚æœè¦ä½¿ç”¨ TypeScript ä¸­çš„ JavaScript åŒ…ï¼Œåˆ™éœ€è¦ç±»å‹ä¿¡æ¯ï¼š

- è½¯ä»¶åŒ…æœ¬èº«å¯èƒ½åŒ…å« `.d.ts` æ–‡ä»¶ï¼Œç”šè‡³å®Œæ•´çš„ TypeScript ä»£ç ã€‚
- å¦‚æœæ²¡æœ‰ï¼Œæˆ‘ä»¬ä»ç„¶å¯ä»¥ä½¿ç”¨å®ƒï¼š[DefinitelyTyped](https://definitelytyped.org/)æ˜¯äººä»¬ä¸ºæ™®é€š JavaScript åŒ…ç¼–å†™çš„å£°æ˜æ–‡ä»¶çš„åº“ã€‚

DefinitelyTyped çš„å£°æ˜æ–‡ä»¶ä½äº `@types` å‘½åç©ºé—´ä¸­ã€‚æ‰€ä»¥å¦‚æœæˆ‘ä»¬éœ€è¦åƒ `lodash` è¿™æ ·çš„åŒ…çš„å£°æ˜æ–‡ä»¶ï¼Œåˆ™å¿…é¡»å®‰è£… `@types/lodash` åŒ…ã€‚

</Info>

<Primary title="1. åŸºç¡€ç±»å‹">

## 1. åŸºç¡€ç±»å‹

ä»¥ä¸‹å·¦è¾¹å¯¹åº” JavaScriptï¼Œå³è¾¹æ˜¯ TypeScript

- Booleanï¼šboolean
- Numberï¼šnumber
- Stringï¼šstring
- ç©ºå€¼ï¼švoidï¼ˆ TS ä¸­çš„ void å¹¶ä¸æ˜¯ JS ä¸­çš„ void ï¼‰
- Nullï¼šnull
- Undefinedï¼šundefined
- Symbolï¼šsymbol
- BigIntï¼šbigint

å¯ä»¥çœ‹å‡ºåŸºæœ¬ä¸Š TS ä¸­çš„åŸºæœ¬ç±»å‹å°±æ˜¯è®² JS ä¸­çš„å„ç§åŸºæœ¬ç±»å‹çš„åŸå‹åæ”¹ä¸ºå°å†™

éœ€è¦æ³¨æ„ï¼Œvoid åœ¨ JS ä¸­æ˜¯ä¸€ä¸ªæ“ä½œç¬¦ï¼Œè¡¨ç¤ºåé¢çš„`function`æˆ–è€…`expression`æ€»æ˜¯è¿”å› undefinedï¼Œä¾‹å¦‚ï¼š

```javascript
let i = void 2 // i === undefined

void (function aRecursion(i) {
  if (i > 0) {
    console.log(i--)
    aRecursion(i)
  }
})(3)

console.log(typeof aRecursion) // undefined
```

è‡³äºå¥½å¤„å°±æ˜¯ï¼Œå¦‚æœä½ çš„ app é‡ŒæŸä¸ªæ¥å£è¦æ±‚å¿…é¡»è¿”å› undefined æˆ–è€…åœ¨å¼‚å¸¸æ—¶åªæ¥å— undefined çš„ç»“æœï¼Œå…¶ä»–ç»“æœä¼šæŠ¥é”™ï¼Œé‚£ä¹ˆç”¨ void å¯ä»¥ä¿è¯ app ä¸ä¼š crashï¼š

```javascript
// returning something else than undefined would crash the app
function middleware(nextCallback) {
  if (conditionApplies()) {
    return void nextCallback()
  }
}
// or
button.onclick = () => void doSomething()
```

è€Œ TS ä¸­çš„ void æ˜¯ä¸€ç§ç±»å‹ï¼Œç›¸å½“äº undefined çš„ä¸€ä¸ªå­ç±»ï¼Œè¡¨ç¤ºå‡½æ•°ä¸è¿”å›å€¼ï¼Œè€Œåœ¨ js é‡Œå¦‚æœå‡½æ•°æ²¡æœ‰æ˜¾ç¤ºè°ƒç”¨ returnï¼Œåˆ™é»˜è®¤è¿”å› undefined ä½œä¸ºå‡½æ•°è¿”å›å€¼ã€‚ç„¶è€Œéœ€è¦æ³¨æ„ï¼ŒTS ä¸­ï¼Œvoid ä¸ç­‰åŒäº undefinedï¼ŒTS å®˜ç½‘å¯¹ `void` çš„å®šä¹‰ï¼š

> `void` represents the return value of functions which donâ€™t return a value. Itâ€™s the inferred type any time a function doesnâ€™t have any `return` statements, or doesnâ€™t return any explicit value from those return statements:

æ³¨æ„æœ€åä¸€å¥è¯ `or doesnâ€™t return any explicit value from those return statements:`ï¼Œæ„æ€å°±æ˜¯ä½ è™½ç„¶å®šä¹‰äº† voidï¼Œä½†æ˜¯ä½œä¸ºå‡½æ•°å¯ä»¥è¿”å›ä»»ä½•å€¼ï¼Œæ‰€ä»¥å¦‚æœä½ ç”¨ undefined å°±ä¼šæŠ¥é”™ä½†æ˜¯ `void` ä¸ä¼šï¼š

```typescript
function doSomething(callback: () => void) {
  // at this position, callback always returns undefined
  let c = callback()
  //c is also of type undefiend
}

// this function returns a number
function aNumberCallback(): number {
  return 2;
}

// works ğŸ‘ type safety is ensured in doSometing
doSomething(aNumberCallback)

// if you change the code above like
- function doSomething(callback: () => void) {
+ function doSomething(callback: () => undefined) { /* ... */ }

function aNumberCallback(): number { return 2; }

// ğŸ’¥ types don't match
doSomething(aNumberCallback)
```

å®˜ç½‘çš„è§£é‡Šè¯´ `void` çš„å«ä¹‰åº”å½“æ˜¯ä¸æŒ‡æœ›å‡½æ•°è¿”å›ä»»ä½•ç»“æœï¼Œå®é™…ä¸Šå‡½æ•°ä½ è¿”å›ä»€ä¹ˆä¸œè¥¿æˆ‘ä¸ careï¼Œæ‰€ä»¥å¯¼è‡´è¿™ä¸ªç»“æœï¼Œæˆ‘è§‰å¾—ä¹Ÿ make senseï¼Œä¸ç„¶ç›´æ¥ç”¨ undefined ä¸å°±å¥½äº†

### P.S. è¡¥å……

1. å¾ˆå¤šæ—¶å€™æˆ‘ä»¬å¹¶ä¸éœ€è¦æ˜¾ç¤ºå£°æ˜å˜é‡çš„ç±»å‹ï¼Œä¾‹å¦‚

```typescript
let msg: string = "hello there!"
// equal to
let msg = "hello there!"
```

å› ä¸º TypeScript èƒ½å¤Ÿæ¨æ–­ï¼ˆinferï¼‰å‡º `msg` å˜é‡æ˜¯ stringï¼Œå¹¶ä¸”åœ¨ IDE ä¸­ï¼Œå½“é¼ æ ‡ hover åœ¨ msg ä¸Šæ—¶ï¼Œä¼šè‡ªåŠ¨å¼¹å‡º TS çš„ç±»å‹æç¤º

2. TS å¯ä»¥åš downleveling ï¼šdownleveling æ˜¯æŒ‡åœ¨ç¼–è¯‘ TS åˆ° JS æ—¶ï¼Œå¯¹åº”çš„ ECMAScript ç‰ˆæœ¬ï¼ŒTS èƒ½å¤Ÿç›´æ¥å°† TS ä»£ç è½¬æ¢æˆä½ç‰ˆæœ¬çš„ ECMAScriptï¼Œ é€šè¿‡ `--target` å‚æ•°å¯ä»¥åœ¨ `tsc` ä¸­æŒ‡å®šï¼Œ ä¾‹å¦‚ï¼š

```shell
tsc --target es2015 input.ts
```

â€‹ æˆ–è€…åœ¨ tsconfig.json ï¼ˆbabelï¼‰ä¸­æŒ‡å®š

3. æœ€ä¸»è¦ã€å®ç”¨çš„ 2 ä¸ª TS ç¼–è¯‘é€‰é¡¹ï¼ˆin tsconfig.jsonï¼‰ï¼š
   - `noImplicitAny`ï¼šå¦‚æœ TS æ¨æµ‹ä¸€ä¸ªå˜é‡ç±»å‹æ˜¯ `any`ï¼Œåˆ™ä¼šæŠ›å‡ºé”™è¯¯ï¼Œé™¤éä½ æ˜¾ç¤ºæŒ‡å®šå˜é‡ç±»å‹æ˜¯ `any` ï¼Œå› ä¸ºå¦‚æœå˜é‡éƒ½æ˜¯ `any`ï¼Œé‚£ä¹Ÿå¤±å»äº†å®ç”¨ TypeScript çš„æ„ä¹‰
   - `strictNullChecks`ï¼šTS ä¸­ï¼Œ`null` å’Œ `undefined` é»˜è®¤å¯ä»¥èµ‹å€¼ä»»ä½•å€¼ï¼Œå› ä¸ºä»»ä½•ç±»å‹éƒ½ä¸èƒ½æ˜ç¡®å®šä¹‰ä¸åŒ…å« `null` å’Œ `undefined`ï¼Œä½†æ˜¯ä¸å¤„ç† `null` å’Œ `undefined` ä¼šé€ æˆå¾ˆå¤šé”™è¯¯ï¼Œä¾‹å¦‚æ³¨æ˜çš„[billion dollar mistake](https://www.youtube.com/watch?v=ybrQvs4x0Ps&ab_channel=JoseCan)ã€‚è€Œåœ¨ä¸¥æ ¼ç©ºæ£€æŸ¥æ¨¡å¼ï¼ˆ`strictNullChecks`ï¼‰ä¸‹ï¼Œ `null` å’Œ `undefined` å€¼éƒ½ _ä¸_ å±äºä»»ä½•ä¸€ä¸ªç±»å‹ï¼Œå®ƒä»¬åªèƒ½èµ‹å€¼ç»™è‡ªå·±è¿™ç§ç±»å‹æˆ–è€… `any` (æœ‰ä¸€ä¸ªä¾‹å¤–ï¼Œ`undefined` ä¹Ÿå¯ä»¥èµ‹å€¼ç»™ `void`)ã€‚å› æ­¤ï¼Œåœ¨å¸¸è§„ç±»å‹æ£€æŸ¥æ¨¡å¼ä¸‹ `T` å’Œ `T | undefined` è¢«è®¤ä¸ºæ˜¯ç­‰åŒçš„ï¼ˆå› ä¸º `undefined` è¢«çœ‹ä½œ `T` çš„å­ç±»å‹ï¼‰ï¼Œä½†å®ƒä»¬åœ¨ä¸¥æ ¼ç±»å‹æ£€æŸ¥æ¨¡å¼ä¸‹æ˜¯ä¸åŒçš„ç±»å‹ï¼Œåªæœ‰ `T | undefined` ç±»å‹å…è®¸å‡ºç° `undefined` å€¼ã€‚`T` å’Œ `T | null` ä¹Ÿæ˜¯è¿™ç§æƒ…å†µã€‚

</Primary>

<Primary title="1* å…¶ä»–å¸¸è§ç±»å‹">

## 1\* å…¶ä»–å¸¸è§ç±»å‹

### unknown

unknown å¤§å¤šæ•°æ—¶å€™å¾ˆ any å¾ˆåƒï¼Œä»£è¡¨ç€å˜é‡å¯ä»¥ä½¿ä»»ä½•æœªçŸ¥çš„ç±»å‹ï¼ŒåŒºåˆ«æ˜¯ unknown å˜é‡ä¸èƒ½å¤Ÿè®¿é—®å±æ€§æˆ–è€…è°ƒç”¨å¯¹è±¡ä¸Šç»‘å®šçš„å‡½æ•°ï¼Œè€Œ any å¯ä»¥ï¼Œå› æ­¤å¯ä»¥è®¤ä¸º unknown æ›´ä¸ºå®‰å…¨

### never

never ç±»å‹è¡¨ç¤ºçš„æ˜¯é‚£äº›æ°¸ä¸å­˜åœ¨çš„å€¼çš„ç±»å‹ï¼Œnever ç±»å‹æ˜¯ä»»ä½•ç±»å‹çš„å­ç±»å‹ï¼Œä¹Ÿå¯ä»¥èµ‹å€¼ç»™ä»»ä½•ç±»å‹ï¼›ç„¶è€Œï¼Œæ²¡æœ‰ç±»å‹æ˜¯ never çš„å­ç±»å‹æˆ–å¯ä»¥èµ‹å€¼ç»™ never ç±»å‹ï¼ˆé™¤äº† never æœ¬èº«ä¹‹å¤–ï¼‰ã€‚

> å³ä½¿ any ä¹Ÿä¸å¯ä»¥èµ‹å€¼ç»™ neverã€‚

ä¸¤ä¸ªåœºæ™¯ä¸­ never æ¯”è¾ƒå¸¸è§:

```
// æŠ›å‡ºå¼‚å¸¸çš„å‡½æ•°æ°¸è¿œä¸ä¼šæœ‰è¿”å›å€¼
function error(message: string): never {
    throw new Error(message);
}
// ç©ºæ•°ç»„ï¼Œè€Œä¸”æ°¸è¿œæ˜¯ç©ºçš„
const empty: never[] = []
```

### å…ƒç»„ï¼ˆTupleï¼‰

å…ƒç»„ç±»å‹ä¸æ•°ç»„ç±»å‹éå¸¸ç›¸ä¼¼ï¼Œè¡¨ç¤ºä¸€ä¸ªå·²çŸ¥å…ƒç´ æ•°é‡å’Œç±»å‹çš„æ•°ç»„ï¼Œå„å…ƒç´ çš„ç±»å‹ä¸å¿…ç›¸åŒã€‚

æ¯”å¦‚ï¼Œä½ å¯ä»¥å®šä¹‰ä¸€å¯¹å€¼åˆ†åˆ«ä¸º`string`å’Œ`number`ç±»å‹çš„å…ƒç»„ã€‚

```
let x: [string, number];
x = ['hello', 10, false] // Error
x = ['hello'] // Error
```

æˆ‘ä»¬çœ‹åˆ°ï¼Œè¿™å°±æ˜¯å…ƒç»„ä¸æ•°ç»„çš„ä¸åŒä¹‹å¤„ï¼Œå…ƒç»„çš„ç±»å‹å¦‚æœå¤šå‡ºæˆ–è€…å°‘äºè§„å®šçš„ç±»å‹æ˜¯ä¼šæŠ¥é”™çš„ï¼Œå¿…é¡»ä¸¥æ ¼è·Ÿäº‹å…ˆå£°æ˜çš„ç±»å‹ä¸€è‡´æ‰ä¸ä¼šæŠ¥é”™ã€‚

é‚£ä¹ˆæœ‰äººä¼šé—®ï¼Œæˆ‘ä»¬çš„ç±»å‹å®Œå…¨ä¸€è‡´ï¼Œåªæ˜¯é¡ºåºé”™äº†æœ‰æ²¡æœ‰é—®é¢˜ï¼Œæ¯”å¦‚ä¸Šä¸ªä¾‹å­ä¸­æˆ‘ä»¬æŠŠ `string`ã€`number` è°ƒæ¢ä½ç½®ï¼š

```
let x: [string, number];
x = ['hello', 10]; // OK
x = [10, 'hello']; // Error
```

æˆ‘ä»¬çœ‹åˆ°ï¼Œå…ƒç»„éå¸¸ä¸¥æ ¼ï¼Œå³ä½¿ç±»å‹çš„é¡ºåºä¸ä¸€æ ·ä¹Ÿä¼šæŠ¥é”™ã€‚

å…ƒç»„ä¸­åŒ…å«çš„å…ƒç´ ï¼Œå¿…é¡»ä¸å£°æ˜çš„ç±»å‹ä¸€è‡´ï¼Œè€Œä¸”ä¸èƒ½å¤šã€ä¸èƒ½å°‘ï¼Œç”šè‡³é¡ºåºä¸èƒ½ä¸ç¬¦ã€‚

æˆ‘ä»¬å¯ä»¥æŠŠå…ƒç»„çœ‹æˆä¸¥æ ¼ç‰ˆçš„æ•°ç»„ï¼Œæ¯”å¦‚`[string, number]`æˆ‘ä»¬å¯ä»¥çœ‹æˆæ˜¯:

```
interface Tuple extends Array<string | number> {
  0: string;
  1: number;
  length: 2;
}
```

å…ƒç»„ç»§æ‰¿äºæ•°ç»„ï¼Œä½†æ˜¯æ¯”æ•°ç»„æ‹¥æœ‰æ›´ä¸¥æ ¼çš„ç±»å‹æ£€æŸ¥ã€‚

### Object

object è¡¨ç¤ºéåŸå§‹ç±»å‹ï¼Œä¹Ÿå°±æ˜¯é™¤ numberï¼Œstringï¼Œbooleanï¼Œsymbolï¼Œnull æˆ– undefined ä¹‹å¤–çš„ç±»å‹ã€‚

```
// è¿™æ˜¯ä¸‹ä¸€èŠ‚ä¼šæåˆ°çš„æšä¸¾ç±»å‹
enum Direction {
    Center = 1
}
let value: object
value = Direction
value = [1]
value = [1, 'hello']
value = {}
```

æˆ‘ä»¬çœ‹åˆ°,æ™®é€šå¯¹è±¡ã€æšä¸¾ã€æ•°ç»„ã€å…ƒç»„é€šé€šéƒ½æ˜¯ `object` ç±»å‹ã€‚

### Enum

å…³äº Enum çš„è¯¦ç»†è®²è§£å¯ä»¥æŸ¥çœ‹[åšå®¢](https://g.yuque.com/cuggz/ts/dzzf93)ç¬¬ 6 èŠ‚ï¼Œè¿™é‡Œä¸»è¦è®²ä¸€ä¸‹æšä¸¾çš„æœ¬è´¨ï¼š

ä¾‹å¦‚å¦‚ä¸‹ ts ä»£ç 

```typescript
enum Direction {
  Up = 10,
  Down,
  Left,
  Right,
}
```

åœ¨ç»è¿‡ `tsc` ç¼–è¯‘è¿‡åä¼šå¾—åˆ°ï¼š

```javascript
var Direction
;(function (Direction) {
  Direction[(Direction["Up"] = 10)] = "Up"
  Direction[(Direction["Down"] = 11)] = "Down"
  Direction[(Direction["Left"] = 12)] = "Left"
  Direction[(Direction["Right"] = 13)] = "Right"
})(Direction || (Direction = {}))
```

ä»è€Œä½ å¯ä»¥å¾—åˆ° `Direction[10] === 'Up'` ä»¥åŠ `Direction['Up'] === 10`ï¼Œä¹Ÿå°±æ˜¯ `key <=> value` åŒå‘ç»‘å®šï¼Œæ‰€ä»¥ Enum å®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªç»è¿‡ç‰¹æ®Šå¤„ç†çš„ Object

æŸ¥çœ‹å¦‚ä¸‹ä»£ç ï¼š

```typescr
enum Enum {
  A,
}

let a = Enum.A;
let nameOfA = Enum[a]; // "A"
```

è¿™æ ·å¯ä»¥çœ‹åˆ°åå‘æ˜ å°„çš„ä½œç”¨ï¼Œä¸è¿‡å®é™…åº”ç”¨åœºæ™¯åº”è¯¥ä¸å¤š

å¦å¤–å…³äº `const` enums å’Œ enums vs objectï¼Œå¯ä»¥æŸ¥çœ‹[å®˜ç½‘](https://www.typescriptlang.org/docs/handbook/enums.html)çš„è¯´æ˜ï¼Œè¿™é‡Œå°±ä¸å†èµ˜è¿°

### å­—é¢é‡ç±»å‹ (Literal Types)

æ˜¯çš„ï¼Œä½ æ²¡çœ‹é”™ï¼Œå­—é¢é‡ä¹Ÿå¯ä»¥æˆä¸ºç±»å‹ï¼Œä¸ä»…å¦‚æ­¤ï¼Œæ•°å­—ä¹Ÿå¯ä»¥ï¼Œä½†æ˜¯è¿™ç§ç±»å‹å°±æ„å‘³ç€åªèƒ½èµ‹å€¼ä¸€ä¸ªå€¼ï¼š

```typescript
let x: "hello" = "hello"
// OK
x = "hello"
// Type '"howdy"' is not assignable to type '"hello"'.
x = "howdy"
```

é‚£ä¹ˆè¿™ç§å­—é¢é‡ç±»å‹æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿ

é€šå¸¸ï¼Œæ˜¯é…åˆ Unionï¼Œä¿è¯è¿™ä¸ªç±»å‹åªæ¥å—è¿™å‡ ç§å€¼ï¼Œå¦åˆ™å°±è®¤ä¸ºæ˜¯é”™è¯¯ï¼Œä»è€Œå¢å¼ºå®‰å…¨æ€§ï¼š

```typescript
function printText(s: string, alignment: "left" | "right" | "center") {
  // ...
}
printText("Hello, world", "left")
printText("G'day, mate", "centre")
// Argument of type '"centre"' is not assignable to parameter of type '"left" | "right" | "center"'.
```

æ•°å­—å­—é¢é‡ç±»å‹ (Numeric literal types)

```typescript
function compare(a: string, b: string): -1 | 0 | 1 {
  return a === b ? 0 : a > b ? 1 : -1
}
```

å½“ç„¶ï¼Œä½ å¯ä»¥ Union å­—é¢é‡å’Œéå­—é¢é‡ç±»å‹

```typescript
interface Options {
  width: number
}
function configure(x: Options | "auto") {
  // ...
}
configure({ width: 100 })
configure("auto")
configure("automatic")
// Argument of type '"automatic"' is not assignable to parameter of type 'Options | "auto"'.
```

boolean ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œå°±ä¸å†èµ˜è¿°

#### å¯¹è±¡ä¸­çš„å­—é¢é‡ç±»å‹

å¦‚æœæ˜¯å¯¹è±¡ä¸­çš„å±æ€§ï¼ŒTypeScript ä¼šå°†å…¶æ¨æ–­ä¸ºæ›´é€šç”¨çš„ç±»å‹ï¼Œä¾‹å¦‚

```typescript
const obj = { counter: 0 }
if (someCondition) {
  obj.counter = 1
}
```

å› ä¸º TS æ¨æ–­ couter æ˜¯ number è€Œä¸æ˜¯ç±»å‹ `0`ï¼Œå†çœ‹ä¸‹é¢è¿™ä¸ªä¾‹å­

```typescript
const req = { url: "https://example.com", method: "GET" }
handleRequest(req.url, req.method)
// Argument of type 'string' is not assignable to parameter of type '"GET" | "POST"'.
```

å‡è®¾ handleRequest è¦æ±‚ method æ˜¯å­—é¢é‡ç±»å‹ `'GET'|'POST'`ï¼Œè¿™æ—¶å€™å°±éœ€è¦ method æ˜¯å­—é¢é‡ç±»å‹è€Œä¸æ˜¯ string äº†ï¼Œé‚£ä¹ˆè¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿç­”æ¡ˆæ˜¯ç”¨ asï¼š

```typescript
// Change 1:
const req = { url: "https://example.com", method: "GET" as "GET" }
// Change 2
handleRequest(req.url, req.method as "GET")
```

2 ç§å†™æ³•éƒ½ workï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œä½ å¯ä»¥åœ¨æ•´ä¸ªå¯¹è±¡å£°æ˜çš„æ—¶å€™å°±ç”¨ `as const`ï¼Œå› ä¸ºè¿™é‡Œçš„ `const` åªåœ¨ TS ä¸­è¯†åˆ«å¤„ç†ï¼Œå› æ­¤ä¼šå½“åšå¯¹è±¡å±æ€§æ˜¯å­—é¢é‡ç±»å‹è€Œä¸æ˜¯ JS ä¸­å±æ€§ä¸å¯å˜çš„æ„æ€äº†ï¼š

```typescript
const req = { url: "https://example.com", method: "GET" } as const
handleRequest(req.url, req.method)
```

è¿™é‡Œï¼Œ`req.method` å°±ä¼šè¢«å½“æˆ `"GET"` ç±»å‹ä»è€Œé€šè¿‡ TS æ£€æŸ¥

</Primary>

<Primary title="2. Type å’Œ Interface">

## 2. Type å’Œ Interface

Type å’Œ Interface çš„åŸºæœ¬ä½¿ç”¨å°±ä¸å†è¯´æ˜ï¼Œå¾ˆå®¹æ˜“æœåˆ°ï¼Œè¿™é‡Œä¸»è¦è®¨è®ºä¸‹å®ƒä»¬ä¹‹é—´çš„åŒºåˆ«ï¼š

ä¸»è¦åŒºåˆ«æ˜¯ type ä¸€æ—¦å®šä¹‰å°±ä¸èƒ½æ·»åŠ æ–°çš„å±æ€§ï¼ˆpropertiesï¼‰ï¼Œè€Œ interface å¯ä»¥ï¼Œå¯ä»¥å‚è€ƒå®˜ç½‘çš„[ä¾‹å­](https://www.typescriptlang.org/docs/handbook/2/everyday-types.html#differences-between-type-aliases-and-interfaces) ï¼ˆä¸‹é¢ä¹Ÿç»™å‡ºäº†ç›¸å…³ codeï¼Œä½†æ˜¯ç”±äºæ²¡èƒ½è§£å†³ MDX æ¸²æŸ“ code block çš„é—®é¢˜ï¼Œæ‰€ä»¥æ²¡æœ‰å®˜ç½‘å±•ç¤ºå¾—æ¸…æ™°ï¼‰

```typescript
// Extending an interface
interface Animal {
  name: string
}

interface Bear extends Animal {
  honey: boolean
}

const bear = getBear()
bear.name
bear.honey

// Extending a type via intersections
type Animal = {
  name: string
}

type Bear = Animal & {
  honey: Boolean
}

const bear = getBear()
bear.name
bear.honey

// Adding new fields to an existing interface
interface Window {
  title: string
}

interface Window {
  ts: TypeScriptAPI
}

const src = 'const a = "Hello World"'
window.ts.transpileModule(src, {})

// A type cannot be changed after being created
type Window = {
  title: string
}

type Window = {
  ts: TypeScriptAPI
}

// Error: Duplicate identifier 'Window'.
```

å¦å¤–è¿˜æœ‰ä»¥ä¸‹å‡ ç‚¹ï¼š

- `type` åœ¨ TS 4.2 ä¹‹å‰æˆ–è®¸ä¼šåœ¨é”™è¯¯æç¤ºä¸­æ˜¾ç¤ºä¸€äº›åŒ¿åç±»å‹ï¼ˆè€Œéä½ æŒ‡å®šçš„ç±»å‹ï¼‰ï¼Œè¿™ä¸ªç»“æœæˆ–è®¸ä¸æ˜¯ä½ æƒ³è¦çš„ï¼Œå¯ä»¥æŸ¥çœ‹å®˜ç½‘çš„[PlayGround](https://www.typescriptlang.org/play?ts=4.2.3#code/PTAEGEHsFsAcEsA2BTATqNrLusgzngIYDm+oA7koqIYuYQJ56gCueyoAUCKAC4AWHAHaFcoSADMaQ0PCG80EwgGNkALk6c5C1EtWgAsqOi1QAb06groEbjWg8vVHOKcAvpokshy3vEgyyMr8kEbQJogAFND2YREAlOaW1soBeJAoAHSIkMTRmbbI8e6aPMiZxJmgACqCGKhY6ABGyDnkFFQ0dIzMbBwCwqIccabcYLyQoKjIEmh8kwN8DLAc5PzwwbLMyAAeK77IACYaQSEjUWZWhfYAjABMAMwALA+gbsVjoADqgjKESytQPxCHghAByXigYgBfr8LAsYj8aQMUASbDQcRSExCeCwFiIQh+AKfAYyBiQFgOPyIaikSGLQo0Zj-aazaY+dSaXjLDgAGXgAC9CKhDqAALxJaw2Ib2RzOISuDycLw+ImBYKQflCkWRRD2LXCw6JCxS1JCdJZHJ5RAFIbFJU8ADKC3WzEcnVZaGYE1ABpFnFOmsFhsil2uoHuzwArO9SmAAEIsSFrZB-GgAjjA5gtVN8VCEc1o1C4Q4AGlR2AwO1EsBQoAAbvB-gJ4HhPgB5aDwem-Ph1TCV3AEEirTp4ELtRbTPD4vwKjOfAuioSQHuDXBcnmgACC+eCONFEs73YAPGGZVT5cRyyhiHh7AAON7lsG3vBggB8XGV3l8-nVISOgghxoLq9i7io-AHsayRWGaFrlFauq2rg9qaIGQHwCBqChtKdgRo8TxRjeyB3o+7xAA)ï¼Œå½“ä½ é€‰æ‹© TS ç‰ˆæœ¬ä½äº 4.2ï¼Œå¹¶ä¸”é¼ æ ‡ hover åœ¨æœ€ä¸‹é¢çš„é”™è¯¯ä»£ç æ—¶ï¼Œæç¤ºä¿¡æ¯ä¸­å¹¶ä¸ä¼šåŒ…å«ä½ æŒ‡å®šçš„ç±»å
- `type` èƒ½å¤Ÿè‡ªå®šä¹‰å‘½ååŸå§‹æ•°æ®ç±»å‹ï¼ˆprimitiveï¼‰ï¼Œè€Œ `interface` ä¸è¡Œ
- è™½ç„¶ TS æ˜¯æ ¹æ®å½¢çŠ¶è¯†åˆ«ç±»å‹çš„ï¼ˆstructural typingï¼‰ï¼Œä½†æ˜¯å¦‚æœä¸æ˜¾ç¤ºæŒ‡å®š `interface` åè€Œå¯¼è‡´çš„æŠ¥é”™ï¼Œåˆ™ä¸ä¼šæ˜¾ç¤ºè¯¥ `interface` åï¼Œå…·ä½“å¯ä»¥çœ‹ä¸‹é¢çš„ä¾‹å­

```typescript
// Compiler error messages will always use
// the name of an interface:

interface Mammal {
  name: string
}

function echoMammal(m: Mammal) {
  console.log(m.name)
}

// e.g. The error below will always use the name Mammal
// to refer to the type which is expected:
echoMammal({ name: 12343 })

// The type of `m` here is the exact same as mammal,
// but as it's not been directly named, TypeScript
// won't mention it in the error messaging

function echoAnimal(m: { name: string }) {
  console.log(m.name)
}

echoAnimal({ name: 12345 })
```

å¤§å¤šæ•°æ—¶å€™ï¼Œä½ å¯ä»¥æ ¹æ®ä¸ªäººå–œå¥½é€‰æ‹©ä½¿ç”¨ `type` è¿˜æ˜¯ `interface`ï¼Œå¦‚æœä½ å–œæ¬¢å¯å‘å¼ç¼–ç¨‹ï¼Œåˆ™è€ƒè™‘ä½¿ç”¨ `interface`ï¼Œ ç›´åˆ°ä½ éœ€è¦ `type`çš„ä¸€äº›ç‰¹æ€§

### 2021-04-09 æ›´æ–°

[Type Casting] å¾ˆå¤šæ—¶å€™æˆ‘ä»¬å¯èƒ½ä¼šåœ¨ cast ç±»å‹ï¼ˆasï¼‰çš„æ—¶å€™é‡åˆ°é—®é¢˜ï¼Œå› ä¸º Type Casting è¦æ±‚è½¬æ¢çš„ç±»å‹å¿…é¡»æ˜¯æ›´ä¸ºç²¾ç¡®çš„ç±»å‹ï¼Œå¦åˆ™ä¸èƒ½è½¬æ¢ï¼Œä¾‹å¦‚ï¼š

```typescript
undefined as number
```

å°±ä¼šæŠ¥é”™ï¼Œå› ä¸º number å¹¶ä¸æ˜¯ undefined çš„ä¸€ä¸ªå­ç±»å‹ï¼Œæ›´è¿›ä¸€æ­¥è¯´ï¼Œå¦‚æœä¸¤ä¸ªç±»å‹æœ‰äº¤å‰ä½†ä¸æ˜¯ç»§æ‰¿ä¹Ÿä¸è¡Œ

ä½†æ˜¯ï¼Œå†çœ‹çœ‹ä¸‹é¢çš„ä»£ç  XD

```typescript
interface A {
  a1: number
  a2: Record<string, unknown>
}
declare let b: Record<string, unknown>
b as A // error
;(b as unknown) as A // pass
```

æŒ‰ç†è¯´ b åº”è¯¥æ˜¯å¯ä»¥ cast ç»™ A çš„ï¼Œä½†æ˜¯å¹¶ä¸è¡Œï¼Œè€Œè¿™ï¼Œä¼¼ä¹æ˜¯ TypeScript çš„ bugï¼å¦‚æœå°† `interface` æ”¹ä¸º `type` å°±å¯ä»¥äº†ï¼Œå¦åˆ™ä½ å°±éœ€è¦åšä¸¤å±‚è½¬æ¢ï¼Œ`(b as unknown) as A`ï¼Œå…¶å®å’Œ `b as any` å·®ä¸å¤šï¼Œè¿™æ · TS ç³»ç»Ÿå¤±å»äº†å¾ˆå¤šæ„ä¹‰ï¼Œä½†æ˜¯ç›¸å¯¹ `any` è€Œè¨€ï¼Œè½¬æ¢ä¸º `unknown` æ›´å®‰å…¨ï¼Œå› ä¸ºä¸èƒ½è®¿é—®å˜é‡å†…éƒ¨å±æ€§

å…³äºè¿™ä¸ª bugï¼Œåœ¨æºç  repo ä¸Šæœ‰ä¸€ä¸ª [issue](https://github.com/microsoft/TypeScript/issues/15300) å¯¹å…¶è¿›è¡Œäº†è¯¦ç»†çš„è®¨è®ºï¼Œç„¶è€Œéå¸¸é—æ†¾ï¼Œåˆ°ç›®å‰ï¼ˆTypeScript 4.2ï¼‰ä¾ç„¶æ²¡èƒ½ fix è¿™ä¸ª bugã€‚æœ‰ä¸€ä½æ€»ç»“è¯´ï¼š

1. A specific type can be saved into a more generic type.
2. A specific interface cannot be saved into a more generic interface. (unexpected)
3. A specific interface can extend an more generic interface.
4. A specific type can be saved into a more generic interface.
5. A specific interface cannot be saved into a more generic type.

çœ‹æ¥ `type` æ¯” `interface` å¥½ç”¨ä¸€äº›ï¼Œä½†æ˜¯ä¸ªäººè§‚ç‚¹æ˜¯å¥½ç”¨é€šå¸¸æ„å‘³ç€ç›¸å¯¹ä¸å®‰å…¨ï¼Œå¯ä»¥çœ‹å‡º `interface` çš„æ£€æŸ¥æ›´ä¸¥æ ¼ï¼Œè™½ç„¶è¿™é‡Œæ˜¯é”™è¯¯æ£€æŸ¥äº†â€¦â€¦å¦å¤–ï¼Œå¾ˆå¤šçŸ¥åçš„ lib ï¼ˆreduxï¼Œrxjsï¼‰é‡Œè¿˜æ˜¯ä½¿ç”¨ `interface` çš„å±…å¤šï¼Œä¼°è®¡ä¹Ÿæ˜¯ç”±äºä¸Šæ–‡æ‰€è¯´çš„ `interface` æ˜“äºæ‰©å±•çš„ç¼˜æ•…ï¼Œæ‰€ä»¥å³ä¾¿æœ‰è¿™ä¸ª bugï¼Œè¿˜æ˜¯ä¼˜å…ˆè€ƒè™‘ä½¿ç”¨ `interfaceã€‚`

</Primary>

<Primary title="3. å‡½æ•°ã€æ³›å‹">
## 3. å‡½æ•°ã€æ³›å‹
å‡½æ•°çš„å‚æ•°å’Œè¿”å›å€¼ç±»å‹å®šä¹‰å°±ä¸å¤šè¯´äº†ï¼Œæ¯”è¾ƒåŸºç¡€ï¼Œè¯´ä¸€ä¸‹è¿›é˜¶çš„ä¸œè¥¿ã€‚

é¦–å…ˆï¼Œå‡½æ•°å¯ä»¥é€šè¿‡ `type`, `interface` å®šä¹‰ï¼Œå¹¶ä¸” `type` æˆ– `interface` å¯ä»¥æ˜¯åŒ…å« function å±æ€§çš„ objectï¼Œå› ä¸º JS ä¸­çš„ Function ä¹Ÿæ˜¯å¯¹è±¡ï¼Œæ‰€ä»¥åªè¦æ˜¯ function çš„å±æ€§ï¼Œéƒ½å¯ä»¥å®šä¹‰ã€‚ä¾‹å¦‚ï¼š

```typescript
type DescribableFunction = {
  description: string
  (someArg: number): boolean
}
function doSomething(fn: DescribableFunction) {
  console.log(fn.description + " returned " + fn(6))
}
```

è¿™é‡Œå®šä¹‰äº† fn çš„ description ç±»å‹ï¼Œè€Œ DescribableFunction ä¾ç„¶æ˜¯å¯ä»¥è°ƒç”¨çš„å‡½æ•°

- æ„é€ å‡½æ•° Constructor

å¯¹äºæ„é€ å‡½æ•°ï¼Œéœ€è¦ä½¿ç”¨ `new` å…³é”®å­—ï¼Œè€Œåœ¨ TS ä¸­ï¼ŒåŒæ ·å¯ä»¥å®šä¹‰æ„é€ å‡½æ•°ï¼Œä¹Ÿæ˜¯ç”¨ `new`

```typescript
type SomeConstructor = {
  new (s: string): SomeObject
}
function fn(ctor: SomeConstructor) {
  return new ctor("hello")
}
```

å¦å¤–ï¼Œæ¯”å¦‚ JS ä¸­çš„ Dateï¼Œæ—¢å¯ä»¥é€šè¿‡ new æ„é€ ï¼Œä¹Ÿå¯ä»¥ä¸ç”¨ newï¼Œç›´æ¥è°ƒç”¨ï¼ˆä½œä¸ºå‡½æ•°ï¼‰ï¼Œå°±å¯ä»¥å¦‚ä¸‹å®šä¹‰ï¼š

```typescript
interface CallOrConstruct {
  new (s: string): Date
  (n?: number): number
}
```

- æ³›å‹ Generic

å±æ€§ Java æˆ–è€… C++ çš„åº”è¯¥å¯¹æ³›å‹å˜æˆä¹Ÿæ¯”è¾ƒå±æ€§ï¼Œç®€å•æ¥è¯´ï¼Œæ³›å‹å°±æ˜¯æˆ‘ä¸æŒ‡å®šå…·ä½“çš„ç±»å‹ï¼Œä½†æ˜¯æˆ‘çŸ¥é“è¿™äº›å˜é‡æ˜¯åŒä¸€ç§ç±»å‹ï¼Œä¾‹å¦‚ï¼š

```typescript
function firstElement<Type>(arr: Type[]): Type {
  return arr[0]
}

// s is of type 'string'
const s = firstElement(["a", "b", "c"])
// n is of type 'number'
const n = firstElement([1, 2, 3])
```

è€Œæ³›å‹çš„ç±»å‹ `T`ï¼Œå¯ä»¥é€šè¿‡ `extends`ï¼Œ`keyof` ç­‰å…³é”®å­—è¿›è¡Œçº¦æŸï¼š

```typescript
function longest<Type extends { length: number }>(a: Type, b: Type) {
  if (a.length >= b.length) {
    return a
  } else {
    return b
  }
}

// longerArray is of type 'number[]'
const longerArray = longest([1, 2], [1, 2, 3])
// longerString is of type 'string'
const longerString = longest("alice", "bob")
// Error! Numbers don't have a 'length' property
const notOK = longest(10, 100)
```

å†æ¥çœ‹ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼Œçœ‹ä¸Šå»ä»¿ä½›æ²¡æœ‰é—®é¢˜ï¼Œä½† TS ä¼šæŠ¥é”™

```typescript
function minimumLength<Type extends { length: number }>(
  obj: Type,
  minimum: number
): Type {
  if (obj.length >= minimum) {
    return obj
  } else {
    return { length: minimum }
    // Type '{ length: number; }' is not assignable to type 'Type'. '{ length: number; }' is assignable to the constraint of type 'Type', but 'Type' could be instantiated with a different subtype of constraint '{ length: number; }'.
  }
}
```

ä½ è¯´è¿”å›å€¼ç¬¦åˆ `{ length: number }` äº†å•Šï¼Ÿè¿™ä¹Ÿæ˜¯å¸¸è§é”™è¯¯ï¼Œå› ä¸ºæˆ‘ä»¬è¦æ±‚å‡½æ•°è¿”å›çš„æ˜¯ Typeï¼Œå®ƒè™½ç„¶ç»§æ‰¿äº† `{ length: number }`ï¼Œä½†å¾ˆæœ‰å¯èƒ½æœ‰æ¯”çˆ¶ç±»æ›´ä¸°å¯Œçš„åŠŸèƒ½ï¼Œè€Œå¦‚æœ TS åªè¦æ±‚æ»¡è¶³çˆ¶ç±»çš„çº¦æŸï¼Œå°±ä¼šå¯¼è‡´ä¸‹é¢çš„ä»£ç ä¹Ÿé€šè¿‡ï¼š

```typescript
// 'arr' gets value { length: 6 }
const arr = minimumLength([1, 2, 3], 6)
// and crashes here because arrays have
// a 'slice' method, but not the returned object!
console.log(arr.slice(0))
```

å¦å¤–ï¼Œé€šå¸¸æ¥è¯´æ³›å‹çš„ç±»å‹æ˜¯ TS è‡ªåŠ¨æ¨æµ‹ï¼ˆinferï¼‰çš„ï¼Œä½†æ˜¯ä½ ä¹Ÿå¯ä»¥è‡ªå·±æŒ‡å®šç±»å‹ï¼Œä¾‹å¦‚ï¼š

```typescript
function combine<Type>(arr1: Type[], arr2: Type[]): Type[] {
  return arr1.concat(arr2)
}

// Type 'string' is not assignable to type 'number'.
const arr = combine([1, 2, 3], ["hello"])

// Correct
const arr = combine<string | number>([1, 2, 3], ["hello"])
```

å¦‚æœä¸æŒ‡å®šï¼ŒTS ä¼šæ¨æµ‹ç±»å‹ä¸º numberï¼Œä»è€ŒæŠ¥é”™ã€‚

æ³›å‹ç¼–ç¨‹è™½ç„¶æœ‰è¶£ï¼Œä½†æœ‰ä¸€äº›åŸåˆ™åº”å½“éµå¾ªï¼š

> **Rule 1**: When possible, use the type parameter itself rather than constraining it

æˆ‘ä»¬åº”å½“å°½é‡ä½¿ç”¨æ›´å°‘çš„ TS å…³é”®å­—å®šä¹‰æ³›å‹ï¼Œå¦åˆ™å› ä¸ºè¿‡äºå¤æ‚ TS å¾ˆå¯èƒ½æ— æ³•æ¨æ–­å‡ºå˜é‡çš„ç±»å‹ï¼Œå½“ä½ é¼ æ ‡ hover åœ¨å˜é‡ä¸Šæ—¶ï¼Œå°±ä¸èƒ½çŸ¥é“å®ƒæ˜¯ä»€ä¹ˆç±»å‹äº†ã€

```typescript
function firstElement1<Type>(arr: Type[]) {
  return arr[0]
}

function firstElement2<Type extends any[]>(arr: Type) {
  return arr[0]
}

// a: number (good)
const a = firstElement1([1, 2, 3])
// b: any (bad)
const b = firstElement2([1, 2, 3])
```

> **Rule 2**: Always use as few type parameters as possible

å¦å¤–ä¸€ä¸ªä¾‹å­

```typescript
function filter1<Type>(arr: Type[], func: (arg: Type) => boolean): Type[] {
  return arr.filter(func)
}

function filter2<Type, Func extends (arg: Type) => boolean>(
  arr: Type[],
  func: Func
): Type[] {
  return arr.filter(func)
}
```

filter1 æ¯” filter2 è¦å¥½ï¼Œå› ä¸º filter2 å‡­ç©ºåˆ›å»ºäº†ä¸€ä¸ªä¸éœ€è¦çš„æ³›å‹ `Func`ï¼Œå¯¹äºå‡½æ•°è°ƒç”¨æ–¹ï¼Œå¿…é¡»æŒ‡å®šä¸€ä¸ªæ— ç”¨çš„ç±»å‹å»é€‚é… `Func`ï¼ŒåŒæ—¶ï¼Œé™ä½äº†å¯è¯»æ€§

> **Rule**: If a type parameter only appears in one location, strongly reconsider if you actually need it

æœ‰æ—¶å€™æˆ‘ä»¬å¹¶ä¸éœ€è¦å®šä¹‰æ³›å‹ï¼Œè€Œæˆ‘ä»¬å¯èƒ½å¹¶æœªæ³¨æ„

```typescript
function greet<Str extends string>(s: Str) {
  console.log("Hello, " + s)
}

greet("world")

function greet(s: string) {
  console.log("Hello, " + s)
}
```

åªæœ‰å½“ `Str` ä½¿ç”¨è¶…è¿‡ 2 æ¬¡çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ‰åº”å½“è€ƒè™‘ä½¿ç”¨å®ƒ

### æœ€åï¼Œæ¥çœ‹çœ‹å‡½æ•°é‡è½½ï¼ˆFunction Overloadsï¼‰

å¯¹äº JS æ¥è¯´ï¼Œæ˜¯ä¸å­˜åœ¨å‡½æ•°é‡è½½çš„ï¼Œå› ä¸ºå‡½æ•°åå¿…é¡»ä¸€è‡´ï¼Œä½†æ˜¯åœ¨ TS ä¸­ï¼Œæœ‰ `Function Overloads` çš„æ¦‚å¿µï¼Œä¸è¿‡ TS ä¸­çš„é‡è½½å’Œä¼ ç»Ÿè¯­è¨€ JAVA|C++ ä¸ä¸€æ ·ï¼ŒTS ä¸­å¯ä»¥æœ‰å¤šä¸ªå‡½æ•°å®šä¹‰ï¼Œä½†æ˜¯åªèƒ½æœ‰ä¸€ä¸ªå‡½æ•°å®ç°ï¼Œä¸ç„¶å°±æ— æ³•ç¼–è¯‘æˆ JS æ–‡ä»¶äº†ï¼Œä¾‹å¦‚ï¼š

```typescript
function makeDate(timestamp: number): Date
function makeDate(m: number, d: number, y: number): Date
function makeDate(mOrTimestamp: number, d?: number, y?: number): Date {
  if (d !== undefined && y !== undefined) {
    return new Date(y, mOrTimestamp, d)
  } else {
    return new Date(mOrTimestamp)
  }
}
const d1 = makeDate(12345678)
const d2 = makeDate(5, 5, 5)
const d3 = makeDate(1, 3)
```

åœ¨ VS Code ä¸­ï¼Œå¦‚æœä½ å°†é¼ æ ‡ hover åœ¨ makeDate è°ƒç”¨çš„åœ°æ–¹ï¼ˆd1,d2,d3ï¼‰ï¼Œä¼šåˆ†åˆ«çœ‹åˆ°å…·ä½“è°ƒç”¨çš„æ˜¯å“ªä¸ªé‡è½½çš„å‡½æ•°ç‰ˆæœ¬ï¼Œè¿™æ ·å¯¹äºå¼€å‘äººå‘˜æ¥è¯´æ— ç–‘æ˜¯ä¸€ä»¶å¹¸ç¦çš„äº‹æƒ…ï¼Œä»£ç å˜å¾—æ›´å¯è¯»äº†~

P.S. å¦å¤–å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœå­˜åœ¨å‚æ•°ä¸ªæ•°ä¸åŒ¹é…çš„æƒ…å†µï¼ˆ2 ä¸ªï¼‰ï¼ŒTS ä¼šé“¾æ¥åˆ°å‚æ•°ä¸ªæ•°å°‘äºå®ƒçš„é‚£ä¸€ä¸ªå®šä¹‰

é‡è½½çš„å‡½æ•°å®šä¹‰å¿…é¡»ç¬¦åˆå‡½æ•°å®ç°ï¼Œå¦åˆ™ TS æŠ¥é”™ï¼š

```typescript
function fn(x: string): void;
function fn() {
  // ...
}
// Expected to be able to call with zero arguments
fn();
Expected 1 arguments, but got 0.
```

```typescript
function fn(x: boolean): void
// Argument type isn't right
function fn(x: string): void
// This overload signature is not compatible with its implementation signature.
function fn(x: boolean) {}
```

å¯¹äºç›¸åŒä¸ªæ•°çš„å‚æ•°ï¼Œåº”å½“å°½é‡è€ƒè™‘ä½¿ç”¨ Union è€Œéé‡è½½ï¼Œè¿™æ ·é”™è¯¯æç¤ºå¯è¯»æ€§æ›´å¼ºï¼š

```typescript
function len(s: string): number
function len(arr: any[]): number
function len(x: any) {
  return x.length
}

len("") // OK
len([0]) // OK
len(Math.random() > 0.5 ? "hello" : [0])
/** 
  No overload matches this call.
  Overload 1 of 2, '(s: string): number', gave the following error.
    Argument of type 'number[] | "hello"' is not assignable to parameter of type 'string'.
      Type 'number[]' is not assignable to type 'string'.
  Overload 2 of 2, '(arr: any[]): number', gave the following error.
    Argument of type 'number[] | "hello"' is not assignable to parameter of type 'any[]'.
      Type 'string' is not assignable to type 'any[]'.
*/

// this is better
function len(x: any[] | string) {
  return x.length
}
```

</Primary>

<Warning title="å‚è€ƒè¿æ¥">

## å‚è€ƒè¿æ¥

1. [Typescript Doc](https://www.typescriptlang.org/docs/handbook)
2. [æ·±å…¥æµ…å‡º TypeScript](https://g.yuque.com/cuggz/ts/kkc0a9)

</Warning>
